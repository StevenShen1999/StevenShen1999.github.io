import{a as T,h as M,i as f,k as w,l as U,j as E,n as k,q as F,o as H,p as v,r as P}from"./VSnackbar.bc774e57.js";import{l as C,N as i,S as p,P as o,n as t,R as l,O as m,Q as g,al as $,am as c,an as D,U as b,M as q}from"./index.d7779145.js";import{_ as V,B as A,V as h,D as _,w as S}from"./VAvatar.84b21b2e.js";import{b as j,V as R,a as W}from"./VDivider.f6645cdf.js";const x=C({props:["topic"],data(){return{topicContent:null,userId:1,submitted:!1}},methods:{closeDialog(e){this.$emit("close-dialog",e)},submitTopic(){this.submitted=!0,T.delete(`${this.$hostname}/api/topics/${this.topic.ID}`).then(e=>{this.closeDialog(e.data)}).catch(e=>{console.log(e),this.closeDialog({status:`Failed, ${e}`})})}},created(){this.topicContent=this.topic.Content}}),O=D("b",null,"This will mark the following topic as Discussed and will no longer be fetchable on the homepage!",-1),Q={class:"text-center"};function z(e,a,n,u,r,y){return i(),p(U,null,{default:o(()=>[t(M,{class:"text-h5"},{default:o(()=>[l(" Confirm Deletion ")]),_:1}),e.submitted?c("",!0):(i(),m("form",{key:0,onSubmit:a[0]||(a[0]=g((...d)=>e.submitTopic&&e.submitTopic(...d),["prevent"]))},[t(f,null,{default:o(()=>[O]),_:1}),t(f,null,{default:o(()=>[l($(e.topicContent),1)]),_:1}),t(w,null,{default:o(()=>[t(A),t(h,{color:"red darken-1",text:"",onClick:g(e.closeDialog,["stop"])},{default:o(()=>[l(" Cancel ")]),_:1},8,["onClick"]),t(h,{color:"red darken-1",text:"",variant:"flat",type:"submit"},{default:o(()=>[l(" Delete ")]),_:1})]),_:1})],32)),e.submitted?(i(),p(f,{key:1},{default:o(()=>[D("div",Q,[t(_,{color:"purple",indeterminate:"",center:""})])]),_:1})):c("",!0)]),_:1})}const G=V(x,[["render",z]]),J=C({props:["topic"],data(){return{topicContent:null,userId:1,submitted:!1}},methods:{closeDialog(e){this.$emit("close-dialog",e)},submitTopic(){this.submitted=!0,T.patch(`${this.$hostname}/api/topics`,{ID:this.topic.ID,content:this.topicContent}).then(e=>{this.closeDialog(e.data)}).catch(e=>{console.log(e),this.closeDialog({status:`Failed, ${e}`})})}},created(){this.topicContent=this.topic.Content}}),K={class:"text-center"};function L(e,a,n,u,r,y){return i(),p(U,null,{default:o(()=>[t(M,{class:"text-h5"},{default:o(()=>[l(" Modify Topic ")]),_:1}),e.submitted?c("",!0):(i(),m("form",{key:0,onSubmit:a[1]||(a[1]=g((...d)=>e.submitTopic&&e.submitTopic(...d),["prevent"]))},[t(f,null,{default:o(()=>[t(E,{modelValue:e.topicContent,"onUpdate:modelValue":a[0]||(a[0]=d=>e.topicContent=d),label:"Topic Content",required:""},null,8,["modelValue"])]),_:1}),t(w,null,{default:o(()=>[t(A),t(h,{color:"red darken-1",text:"",onClick:g(e.closeDialog,["stop"])},{default:o(()=>[l(" Cancel ")]),_:1},8,["onClick"]),t(h,{color:"green darken-1",text:"",variant:"flat",type:"submit"},{default:o(()=>[l(" Submit ")]),_:1})]),_:1})],32)),e.submitted?(i(),p(f,{key:1},{default:o(()=>[D("div",K,[t(_,{color:"purple",indeterminate:"",center:""})])]),_:1})):c("",!0)]),_:1})}const X=V(J,[["render",L]]),Y=C({data(){return{snackbar:!1,errorMessage:null,modifyDialog:!1,deleteDialog:!1,targetTopic:null,dataSource:null,headers:[{text:"Topic",value:"Content"},{text:"Updated",value:"UpdatedAt",sortable:!0},{text:"Discussed",value:"DeletedAt",sortable:!0},{text:"Actions",value:"Actions"}]}},methods:{modifyTopic(e){this.targetTopic=e,this.modifyDialog=!0},deleteTopic(e){this.targetTopic=e,this.deleteDialog=!0},handleModification(e){if(this.targetTopic=null,this.modifyDialog=!1,this.deleteDialog=!1,this.errorMessage=null,e.status)this.errorMessage=e.status;else if(e.ID)console.log("Success!");else return;this.snackbar=!0,this.fetchTopics({deleted:!0})},fetchTopics(e){this.dataSource=null;let a=`${this.$hostname}/api/topics`,n="?";e.deleted&&(n+="all=true"),n!=="?"&&(a+=n),T.get(`${a}`).then(u=>{this.dataSource=u.data,this.dataSource.forEach(r=>{r.CreatedAt=r.CreatedAt,r.UpdatedAt=r.UpdatedAt})}).catch(u=>{console.log(u)})},save(e){console.log(e)}},mounted(){this.fetchTopics({deleted:!0})},components:{ConfirmDelete:G,ModifyTopic:X}});const Z={key:0,class:"text-center"},ee={style:{padding:"15px"}},te={key:0};function oe(e,a,n,u,r,y){const d=b("ModifyTopic"),I=b("ConfirmDelete"),B=b("EasyDataTable");return i(),m(q,null,[t(R,{flat:""},{default:o(()=>[t(j,{style:{"text-align":"center"}},{default:o(()=>[l("History of Us")]),_:1})]),_:1}),t(W,{class:"mx-4",vertical:""}),e.dataSource?c("",!0):(i(),m("div",Z,[t(_,{indeterminate:"",color:"green"})])),t(k,{modelValue:e.modifyDialog,"onUpdate:modelValue":a[0]||(a[0]=s=>e.modifyDialog=s),"max-width":"500"},{default:o(()=>[t(d,{onCloseDialog:e.handleModification,topic:e.targetTopic},null,8,["onCloseDialog","topic"])]),_:1},8,["modelValue"]),t(k,{modelValue:e.deleteDialog,"onUpdate:modelValue":a[1]||(a[1]=s=>e.deleteDialog=s),"max-width":"500"},{default:o(()=>[t(I,{onCloseDialog:e.handleModification,topic:e.targetTopic},null,8,["onCloseDialog","topic"])]),_:1},8,["modelValue"]),t(F,{class:"fill-height"},{default:o(()=>[e.dataSource?(i(),p(B,{key:0,headers:e.headers,items:e.dataSource,"rows-per-page":10},{"item-actions":o(s=>[t(S,{icon:"mdi-pencil-off",class:"crud-icons",onClick:N=>e.modifyTopic(s)},null,8,["onClick"]),t(S,{icon:"mdi-delete",class:"crud-icons",onClick:N=>e.deleteTopic(s)},null,8,["onClick"])]),expand:o(s=>[D("div",ee,[s.Description?(i(),m("b",te,"Description:")):c("",!0),l(" "+$(s.Description),1)])]),_:1},8,["headers","items"])):c("",!0)]),_:1}),t(P,{modelValue:e.snackbar,"onUpdate:modelValue":a[3]||(a[3]=s=>e.snackbar=s)},{default:o(()=>[t(H,{class:"d-flex align-center justify-space-between"},{default:o(()=>[t(v,{cols:"auto"},{default:o(()=>[l($(e.errorMessage?`Something Went Wrong: ${e.errorMessage}`:"Success"),1)]),_:1}),t(v,{cols:"auto"},{default:o(()=>[t(h,{color:"pink",text:"",onClick:a[2]||(a[2]=s=>e.snackbar=!1)},{default:o(()=>[l(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const ae=V(Y,[["render",oe]]),re=C({__name:"History",setup(e){return(a,n)=>(i(),p(ae))}});export{re as default};
