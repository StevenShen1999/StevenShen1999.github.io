import{a as b,V as S,b as f,d as M,e as w,c as E,f as k,i as F,g as H,h as _,j as P}from"./VSnackbar.3f2242b4.js";import{l as C,N as l,S as u,P as o,n as t,R as s,O as h,Q as g,ah as U,ai as p,aj as V,U as D,M as j}from"./index.a65e4d6b.js";import{_ as T,B as A,V as m,D as $,w as v}from"./VAvatar.073cfa79.js";import{b as q,V as R,a as W}from"./VDivider.0d94290c.js";const O=C({props:["topic"],data(){return{topicContent:null,userId:1,submitted:!1}},methods:{closeDialog(e){this.$emit("close-dialog",e)},submitTopic(){this.submitted=!0,b.delete(`${this.$hostname}/api/topics/${this.topic.ID}`).then(e=>{this.closeDialog(e.data)}).catch(e=>{console.log(e),this.closeDialog({status:`Failed, ${e}`})})}},created(){this.topicContent=this.topic.Content}}),Q=V("b",null,"This will mark the following topic as Discussed and will no longer be fetchable on the homepage!",-1),z={class:"text-center"};function G(e,a,n,c,r,y){return l(),u(w,null,{default:o(()=>[t(S,{class:"text-h5"},{default:o(()=>[s(" Confirm Deletion ")]),_:1}),e.submitted?p("",!0):(l(),h("form",{key:0,onSubmit:a[0]||(a[0]=g((...d)=>e.submitTopic&&e.submitTopic(...d),["prevent"]))},[t(f,null,{default:o(()=>[Q]),_:1}),t(f,null,{default:o(()=>[s(U(e.topicContent),1)]),_:1}),t(M,null,{default:o(()=>[t(A),t(m,{color:"red darken-1",text:"",onClick:g(e.closeDialog,["stop"])},{default:o(()=>[s(" Cancel ")]),_:1},8,["onClick"]),t(m,{color:"red darken-1",text:"",variant:"flat",type:"submit"},{default:o(()=>[s(" Delete ")]),_:1})]),_:1})],32)),e.submitted?(l(),u(f,{key:1},{default:o(()=>[V("div",z,[t($,{color:"purple",indeterminate:"",center:""})])]),_:1})):p("",!0)]),_:1})}const J=T(O,[["render",G]]),K=C({props:["topic"],data(){return{topicContent:null,userId:1,submitted:!1}},methods:{closeDialog(e){this.$emit("close-dialog",e)},submitTopic(){this.submitted=!0,b.patch(`${this.$hostname}/api/topics`,{ID:this.topic.ID,content:this.topicContent}).then(e=>{this.closeDialog(e.data)}).catch(e=>{console.log(e),this.closeDialog({status:`Failed, ${e}`})})}},created(){this.topicContent=this.topic.Content}}),L={class:"text-center"};function X(e,a,n,c,r,y){return l(),u(w,null,{default:o(()=>[t(S,{class:"text-h5"},{default:o(()=>[s(" Modify Topic ")]),_:1}),e.submitted?p("",!0):(l(),h("form",{key:0,onSubmit:a[1]||(a[1]=g((...d)=>e.submitTopic&&e.submitTopic(...d),["prevent"]))},[t(f,null,{default:o(()=>[t(E,{modelValue:e.topicContent,"onUpdate:modelValue":a[0]||(a[0]=d=>e.topicContent=d),label:"Topic Content",required:""},null,8,["modelValue"])]),_:1}),t(M,null,{default:o(()=>[t(A),t(m,{color:"red darken-1",text:"",onClick:g(e.closeDialog,["stop"])},{default:o(()=>[s(" Cancel ")]),_:1},8,["onClick"]),t(m,{color:"green darken-1",text:"",variant:"flat",type:"submit"},{default:o(()=>[s(" Submit ")]),_:1})]),_:1})],32)),e.submitted?(l(),u(f,{key:1},{default:o(()=>[V("div",L,[t($,{color:"purple",indeterminate:"",center:""})])]),_:1})):p("",!0)]),_:1})}const Y=T(K,[["render",X]]),Z=C({data(){return{snackbar:!1,errorMessage:null,modifyDialog:!1,deleteDialog:!1,targetTopic:null,dataSource:null,headers:[{text:"Topic",value:"Content"},{text:"Updated",value:"UpdatedAt",sortable:!0},{text:"Discussed",value:"DeletedAt",sortable:!0},{text:"Actions",value:"Actions"}]}},methods:{modifyTopic(e){this.targetTopic=e,this.modifyDialog=!0},deleteTopic(e){this.targetTopic=e,this.deleteDialog=!0},handleModification(e){if(this.targetTopic=null,this.modifyDialog=!1,this.deleteDialog=!1,this.errorMessage=null,e.status)this.errorMessage=e.status;else if(e.ID)console.log("Success!");else return;this.snackbar=!0,this.fetchTopics({deleted:!0})},fetchTopics(e){this.dataSource=null;let a=`${this.$hostname}/api/topics`,n="?";e.deleted&&(n+="all=true"),n!=="?"&&(a+=n),b.get(`${a}`).then(c=>{this.dataSource=c.data,this.dataSource.forEach(r=>{r.CreatedAt=r.CreatedAt,r.UpdatedAt=r.UpdatedAt})}).catch(c=>{console.log(c)})},save(e){console.log(e)}},mounted(){this.fetchTopics({deleted:!0})},components:{ConfirmDelete:J,ModifyTopic:Y}});const x={key:0,class:"text-center"};function ee(e,a,n,c,r,y){const d=D("ModifyTopic"),I=D("ConfirmDelete"),B=D("EasyDataTable");return l(),h(j,null,[t(R,{flat:""},{default:o(()=>[t(q,{style:{"text-align":"center"}},{default:o(()=>[s("History of Us")]),_:1})]),_:1}),t(W,{class:"mx-4",vertical:""}),e.dataSource?p("",!0):(l(),h("div",x,[t($,{indeterminate:"",color:"green"})])),t(k,{modelValue:e.modifyDialog,"onUpdate:modelValue":a[0]||(a[0]=i=>e.modifyDialog=i),"max-width":"500"},{default:o(()=>[t(d,{onCloseDialog:e.handleModification,topic:e.targetTopic},null,8,["onCloseDialog","topic"])]),_:1},8,["modelValue"]),t(k,{modelValue:e.deleteDialog,"onUpdate:modelValue":a[1]||(a[1]=i=>e.deleteDialog=i),"max-width":"500"},{default:o(()=>[t(I,{onCloseDialog:e.handleModification,topic:e.targetTopic},null,8,["onCloseDialog","topic"])]),_:1},8,["modelValue"]),t(F,{class:"fill-height"},{default:o(()=>[e.dataSource?(l(),u(B,{key:0,headers:e.headers,items:e.dataSource,"rows-per-page":10},{"item-actions":o(i=>[t(v,{icon:"mdi-pencil-off",class:"crud-icons",onClick:N=>e.modifyTopic(i)},null,8,["onClick"]),t(v,{icon:"mdi-delete",class:"crud-icons",onClick:N=>e.deleteTopic(i)},null,8,["onClick"])]),_:1},8,["headers","items"])):p("",!0)]),_:1}),t(P,{modelValue:e.snackbar,"onUpdate:modelValue":a[3]||(a[3]=i=>e.snackbar=i)},{default:o(()=>[t(H,{class:"d-flex align-center justify-space-between"},{default:o(()=>[t(_,{cols:"auto"},{default:o(()=>[s(U(e.errorMessage?`Something Went Wrong: ${e.errorMessage}`:"Success"),1)]),_:1}),t(_,{cols:"auto"},{default:o(()=>[t(m,{color:"pink",text:"",onClick:a[2]||(a[2]=i=>e.snackbar=!1)},{default:o(()=>[s(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const te=T(Z,[["render",ee]]),ie=C({__name:"History",setup(e){return(a,n)=>(l(),u(te))}});export{ie as default};
